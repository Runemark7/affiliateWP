<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- css -->
    <link href="css/style.css" rel="stylesheet" type="text/css">
    <link href="css/menu.css" rel="stylesheet" type="text/css">
    <link href="css/content.css" rel="stylesheet" type="text/css">
    <link href="css/smallshit.css" rel="stylesheet" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
  
    <!-- js -->
    <script src="js/everything.js"></script>
  
    <title>Worryless - Affiliate</title>
</head>
<body>
<div id="topbar-wrapper">
    <div id="topbar">
        <div id="topbar-title"><a href="#"><img src="https://worryless.se/wp-content/uploads/2018/11/worryless-text-1024x73.png"></img></a></div>
        <div id="clock"></div>
       
        <div id="topbar-account">
            <div id="topbar-account-title">Konto</div>
            <div id="dropdown-item-wrapper">
                <% if(userid != null){ %>
                <div class="dropdown-item">
                    <a href="konto" class="dropdown-link">
                        <span>Mitt konto</span>
                    </a>
                </div>
                <div class="dropdown-item">
                    <a href="konto/settings" class="dropdown-link">
                        <span>Inställningar</span>
                    </a>
                </div>
                <div class="dropdown-item">
                    <a href="konto/logout" class="dropdown-link">
                        <span>Logout</span>
                    </a>
                </div>
                <% }else{ %>
                <div class="dropdown-item">
                    <a href="konto/login" class="dropdown-link">
                        <span>Logga in</span>
                    </a>
                </div>
                <div class="dropdown-item">
                    <a href="konto/register" class="dropdown-link">
                        <span>Registrera</span>
                    </a>
                </div>
                <% } %>
            </div>
        </div>
    </div>
</div>
    
<div id="wrapper">
    <div id="menu-wrapper">
        <ul id="navbar">
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <span>Startsida</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <span>statistik</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="konto/rabattkod" class="nav-link">
                    <span>Rabattkod</span>
                </a>
            </li>
        </ul>
    </div>

    <div id="content-wrapper">
        <h5 id="contentTitle">Datan innefattar de 30 senaste dagarna</h5>
            <div id="cardWrapper">
                <div class="chart-inside">
                    <div class="chart-inside-inside">
                        <div class="chartTitle"><span>Försäljning</span>
                            <div class="amount"><%- total_sale %> KR</div> <div class="percentage"></div>
                        </div>    
                    </div>
                </div>
                <div class="chart-inside">
                    <div class="chart-inside-inside">
                        <div class="chartTitle"><span>Din andel (20%)</span>
                            <div class="amount"><%- Math.round(total_sale*0.2) %> KR</div> <div class="percentage"></div>
                        </div>
                    </div>
                </div>
                <div class="chart-inside">
                    <div class="chart-inside-inside">
                        <div class="chartTitle"><span>Total Revenue</span>
                            <div class="amount">något</div> <div class="percentage"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="chartWrapper-inside">
                <div class="inside-chart">
                    <div class="chart">
                            <canvas id="myChart1" ></canvas>
                    </div> 
                </div>
                <div class="inside-chart">
                    <div id="totalorders_wrapper">
                        <form action="getdate" method="post">
                            <input type="date" name="dateStart" id="calender">
                            <input type="date" name="dateStop" id="calender">
                            <input type="submit" value="Get data">
                        </form>
                    </div>
                </div>
             </div>
        <script>
       
        var ctx = document.getElementById('myChart1').getContext('2d');
        var chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ["Måndag", "Tisdag", "Onsdag", "Torsdag", "Fredag", "Lördag", "Söndag"],
                datasets: [{
                    fillColor: "rgba(120,120,120,0.2)",
                    strokeColor: "rgba(120,120,120,1)",
                    pointColor: "rgba(120,120,120,1)",
                    pointStrokeColor: "#fff",
                    pointHighlightFill: "#fff",
                    pointHighlightStroke: "rgba(120,120,120,1)",
                    pointHoverRadius: 5,
                    pointHoverBackgroundColor: 'red',
                    data: [{
                        x: new Date(),
                        y: "<%- Math.round(måndag) %>"
                    }, {
                        t: new Date(),
                        y: "<%- Math.round(tisdag) %>"
                    },
                    {
                        x: new Date(),
                        y: "<%- Math.round(onsdag) %>"
                    },
                    {
                        x: new Date(),
                        y: "<%- Math.round(torsdag) %>"
                    },
                    {
                        x: new Date(),
                        y: "<%- Math.round(fredag) %>" 
                    },
                    {
                        x: new Date(),
                        y: "<%- Math.round(lördag) %>"
                    },
                    {
                        x: new Date(),
                        y: "<%- Math.round(söndag) %>"
                    }],
                    
                }]
            },
            options : {
                    scales : {
                        xAxes : [ {
                            gridLines : {
                                display : false
                            }
                        } ],
                        yAxes : [ {
                            gridLines : {
                                display : false
                            }
                        } ]
                    },
                    legend: {
                            display: false
                        },
                        tooltips: {
                            callbacks: {
                            label: function(tooltipItem) {
                                    return tooltipItem.yLabel;
                            }
                            }
                        }
                }
        });

        </script>
        <div id="order-wrapper">
            <div id="orders-wrapper"> 
                <% order_info.forEach(res=>{ %>
                    <div id="orders">
                        <div class="orderItem"><%- res['post_modified'].toString().split(" ").splice(0,5).join(" ") %></div>
                        <div class="orderItem"><%- Math.round(res['meta_value']) %> kr</div>
                        <% if(res['post_status'] == "wc-cancelled"){ %>
                        <div class="orderItem"><div id="red"></div>Avbruten</div>
                        <% }else if(res['post_status'] == "wc-processing"){ %>
                        <div class="orderItem"><div id="orange"></div>Behandlas</div>
                        <% }else{ %>
                        <div class="orderItem"><div id="green"></div>Färdig</div>  
                        <% } %>
                    </div>
                <% }); %>
            </div>

        </div>

    </div>
</div>

</body>
</html>